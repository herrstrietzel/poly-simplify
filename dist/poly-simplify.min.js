!function(e){"use strict";function t(e){return function(e){let t=[{type:"M",values:e[0].values}],a=t[0];for(let l=1,n=e.length;l<n;l++){let n=e[l],{type:r,values:s}=n,i=s.length,o=a.values,u=o.length,[p,h]=[s[i-2],s[i-1]],[y,c]=[o[u-2],o[u-1]];switch(r){case"H":a={type:"L",values:[s[0],c]};break;case"V":a={type:"L",values:[y,s[0]]};break;case"z":case"Z":a={type:"Z",values:[]};break;case"M":a={type:"M",values:[s[0],s[1]]};break;default:a={type:"L",values:[p,h]}}t.push(a)}return t}(l(function(e,t=!0){const a={77:2,109:2,65:7,97:7,67:6,99:6,72:1,104:1,76:2,108:2,81:4,113:4,83:4,115:4,84:2,116:2,86:1,118:1,90:0,122:0};let l=new Set([...Object.keys(a).map(Number)]);const n=new Set([5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279]);function r(e){return 10===e||13===e||8232===e||8233===e||44===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&n.has(e)>=0}function s(e){return l.has(e)}let i,o=0,u=e.length,p="",h=[],y=-1,c="",f=!1,g=!1,m=0,x=0,d=0,v=!1,w=[];const M=()=>{v&&("M"===p?p="L":"m"===p&&(p="l"),h.push({type:p,values:[]}),y++,x=0,v=!1)},b=(e=!1)=>{(e?m>0:""!==c)&&(t&&-1===y&&(i="Pathdata must start with M command",w.push(i),p="M",h.push({type:p,values:[]}),d=2,x=0,y++),"A"===p||"a"===p?(c=A(),h[y].values.push(...c)):(t&&c[1]&&"."!==c[1]&&"0"===c[0]&&(i="Leading zeros not valid: "+c,w.push(i)),h[y].values.push(+c)),x++,c="",m=0,v=x>=d)},A=()=>{let e=c.length,t=!1;return 3===x&&2===e||4===x&&e>1?(c=[+c[0],+c[1]],t=!0,x++):3===x&&e>=3&&(c=[+c[0],+c[1],+c.substring(2)],t=!0,x+=2),t?c:[+c]},$=()=>{if(t){let e=y>0?h[y]:0,t=e?e.values.length:0;(t&&t<d||t&&t>d||("z"===p||"Z"===p)&&t>0)&&(i=`Pathdata commands in "${p}" (segment index: ${y}) don't match allowed number of values: ${d-t}/${d}`,w.push(i))}};for(;o<u;){let t=e[o],l=e.charCodeAt(o);if(s(l)){""!==c&&(h[y].values.push(+c),x++,c=""),$(),p=t,d=a[l];let e="M"===p||"m"===p;y>0&&("z"===h[y].type||"Z"===h[y].type)&&!e&&(h.push({type:"m",values:[0,0]}),y++),h.push({type:p,values:[]}),y++,g=!1,m=0,x=0,v=!1,o++}else if(r(l))b(),g=!0,f=!1,o++;else{if(o===u-1){c+=t,b(),g=!1,f=!1,$();break}if(!f&&!g&&45===l||!f&&46===l){let e=46===l;b(e),M(),e&&m++}else M();c+=t,f=69===l||101===l,g=!1,o++}}if($(),h[0].type="M",t&&w.length){if(i="Invalid path data:\n"+w.join("\n"),"log"!==t)throw new Error(i);console.warn(i)}return h}(e),!1))}function a(e){let t=[{x:e[0].values[0],y:e[0].values[1]}];for(let a=1,l=e.length;a<l;a++){let{values:l}=e[a];if(l.length){let e=l.slice(-2);t.push({x:e[0],y:e[1]})}}return t}function l(e,t=!1){let a=e[0].values,l=a[0],n=a[1],r=l,s=n;for(let a=1,i=e.length;a<i;a++){let i=e[a],{type:o,values:u}=i,p=t?o.toLowerCase():o.toUpperCase();if(o!==p)switch(o=p,i.type=o,o){case"a":case"A":u[5]=t?u[5]-l:u[5]+l,u[6]=t?u[6]-n:u[6]+n;break;case"v":case"V":u[0]=t?u[0]-n:u[0]+n;break;case"h":case"H":u[0]=t?u[0]-l:u[0]+l;break;case"m":case"M":t?(u[0]-=l,u[1]-=n):(u[0]+=l,u[1]+=n),r=t?u[0]+l:u[0],s=t?u[1]+n:u[1];break;default:if(u.length)for(let e=0;e<u.length;e++)u[e]=t?u[e]-(e%2?n:l):u[e]+(e%2?n:l)}let h=u.length;switch(o){case"z":case"Z":l=r,n=s;break;case"h":case"H":l=t?l+u[0]:u[0];break;case"v":case"V":n=t?n+u[0]:u[0];break;case"m":case"M":r=u[h-2]+(t?l:0),s=u[h-1]+(t?n:0);default:l=u[h-2]+(t?l:0),n=u[h-1]+(t?n:0)}}return e[0].type="M",e}function n(e,t=-1,a=!1,n=!1){return n&&(e=function(e){let t,a=[{type:"M",values:e[0].values}],l=a[0],n={x:e[0].values[0],y:e[0].values[1]},r=.01;for(let s=1,i=e.length;s<i;s++){let i=e[s],{type:o,values:u}=i,p=u.length?u.slice(-2):[];t={x:p[0],y:p[1]};let h=Math.abs(t.x-n.x),y=Math.abs(t.y-n.y),c=(h+y)/2*r;switch(o){case"L":l=0===y||y<c&&h>c?{type:"H",values:[u[0]]}:0===h||y>c&&h<c?{type:"V",values:[u[1]]}:i;break;case"M":case"Z":case"z":l={type:o,values:p};break;default:l={type:"L",values:p}}n={x:p[0],y:p[1]},a.push(l)}return a}(e)),a&&(e=function(e){return l(e,!0)}(e)),t>-1&&(e=e.map((e=>({type:e.type,values:e.values.map((e=>+e.toFixed(t)))})))),e}function r(e,t=1){let a=t>1,l=!a;"l"===(e=JSON.parse(JSON.stringify(e)))[1].type&&l&&(e[0].type="m");let n="";n=a?`${e[0].type} ${e[0].values.join(" ")}\n`:`${e[0].type}${e[0].values.join(" ")}`;for(let t=1,r=e.length;t<r;t++){let r=e[t-1],s=e[t],{type:i,values:o}=s;if(!l||"A"!==i&&"a"!==i||(o=[o[0],o[1],o[2],`${o[3]}${o[4]}${o[5]}`,o[6]]),i=r.type===s.type&&"m"!==s.type.toLowerCase()&&l||("m"===r.type&&"l"===s.type||"M"===r.type&&"l"===s.type||"M"===r.type&&"L"===s.type)&&l?" ":s.type,l){let e="",t=!1;for(let a=0,l=o.length;a<l;a++){let l=o[a],n=l.toString(),r=n.includes(".")&&Math.abs(l)<1;r&&t&&(n=n.replace(/^0\./,".")),!(a>0)||t&&r||(e+=" "),e+=n,t=r}n+=`${i}${e}`}else n+=a?`${i} ${o.join(" ")}\n`:`${i}${o.join(" ")}`}return l&&(n=n.replace(/ 0\./g," .").replace(/ -/g,"-").replace(/-0\./g,"-.").replace(/Z/g,"z")),n}function s(e){if(!e||!e.length)return[];let l=e[0].x||!1;if(l&&e.length>0&&"object"==typeof e[0]&&e[0].constructor!==Object&&(e=>{let t=e.length,a=new Array(t);for(let l=0;l<t;l++)a[l]={x:e[l].x,y:e[l].y}})(e),l)return e;let n="string"==typeof e,r=!1;if(!!n&&(e.startsWith("M")||e.startsWith("m"))){0;let l=t(e),n=function(e){let t=[];try{e.map(((e,t)=>"m"===e.type.toLowerCase()?t:-1)).filter((e=>-1!==e))}catch{console.log("catch",e)}let a=e.map(((e,t)=>"m"===e.type.toLowerCase()?t:-1)).filter((e=>-1!==e));return 1===a.length?[e]:(a.forEach(((l,n)=>{t.push(e.slice(l,a[n+1]))})),t)}(l);r=n.length>1;let s=[];return r?n.forEach((e=>{let t=a(e);s.push(t)})):s=a(l),s}if(!!n&&(e.startsWith("{")||e.startsWith("["))&&(e=JSON.parse(e),n=!1),n){if((e=e.trim().split(/,| /).filter(Boolean).map(Number)).filter((e=>isNaN(e))).length)return console.warn("input doesn't contain point data â€“ please, check your input structure for syntax errors"),[]}return Array.isArray(e)&&2===e[0].length&&(e=e.map((e=>({x:e[0],y:e[1]})))),!Array.isArray(e[0])&&!e[0].hasOwnProperty("x")&&(e=(e=>{let t=[];for(let a=1,l=e.length;a<l;a+=2)t.push({x:e[a-1],y:e[a]});return t})(e)),e}function i(e,t){return(t.x-e.x)**2+(t.y-e.y)**2}function o(e){let t=i(e[0],e[1]);for(let a=3,l=e.length;a<l;a++){let l=i(e[a-1],e[a]);if(100/t*Math.abs(t-l)>.1)return!1;t=l}return!0}function u(e,t=48){if(!Array.isArray(e)||e.length<=t)return e;let a=e.length,l=a/t,n=[];for(let a=0;a<t;a++)n.push(e[Math.floor(a*l)]);let r=n.length;return n[r-1]!==e[a-1]&&(n[r-1]=e[a-1]),n}function p(e,t=!1){let a=0;for(let t=0,l=e.length;l&&t<l;t++){a+=e[t].x*e[t===e.length-1?0:t+1].y*.5-e[t===e.length-1?0:t+1].x*e[t].y*.5}return t?Math.abs(a):a}function h(e){let t=e.map((e=>e.x)),a=e.map((e=>e.y)),l=Math.min(...t),n=Math.max(...t),r=Math.min(...a),s=Math.max(...a);return{x:l,left:l,right:n,y:r,top:r,bottom:s,width:n-l,height:s-r}}function y(e,t,a="points",l=!1,s=-1,o=!1,y=!1,c=!1,f=1,g=0,m=0,x=!1,d=0,v=0){let w={data:[],ptsArr:[],countOriginal:0,count:0,areaOriginal:0,areaptsSmp:0,areaDiff:0,isPolygon:[]};t=function(e,t=1,a=0,l=0,n=!1,r=0,s=0){if(1===t&&0===r&&0===s&&0===a&&0===l&&!1===n)return e;let i,o,u,p,y=Array.isArray(e[0]),c=y?e:[e],f=y?e.flat():e;return({x:i,y:o,width:u,height:p}=h(f)),c.forEach(((e,h)=>{t=r?r/u:s?s/p:t,s&&p*t>s&&(t=s/p),n&&(a=-i,l=-o);for(let n=0,r=e.length;n<r;n++){let r=e[n];c[h][n]={x:(r.x+a)*t,y:(r.y+l)*t}}})),c}(t,f,g,m,x,d,v);for(let a=0,n=t.length;a<n;a++){let n=e[a],r=t[a],s=n.length;w.countOriginal+=s;let o=r.length;w.count+=o,w.ptsArr.push(r);let y=!1;if(l){let e=p(n,!0),t=p(r,!0);w.areaOriginal=e,w.areaptsSmp=t;let a=u(n,32),{width:s,height:o}=h(a),c=(Math.max(s,o)/n.length)**2;y=i(n[0],n[n.length-1])<c,w.isPolygon.push(y);let f=l?+(100/t*Math.abs(e-t)).toFixed(3):0;w.areaDiff+=f}}switch(a=a?a.toLowerCase():"points"){case"points":case"pointstring":case"pointsnested":case"json":s>-1&&(w.ptsArr=w.ptsArr.map((e=>e.map((e=>({x:+e.x.toFixed(s),y:+e.y.toFixed(s)})))))),"pointstring"===a?w.data=w.ptsArr.map((e=>e.map((e=>`${e.x} ${e.y}`)).join(" "))):"points"===a?w.data=w.ptsArr:"pointsnested"===a?w.data=w.ptsArr.map((e=>e.map((e=>[e.x,e.y])))):"json"===a&&(w.data=JSON.stringify(w.ptsArr));break;case"pathdata":case"path":let e=[];w.ptsArr.forEach(((t,a)=>{let l=[{type:"M",values:[t[0].x,t[0].y]},...t.slice(1).map((e=>({type:"L",values:[e.x,e.y]})))];w.isPolygon[a]&&l.push({type:"Z",values:[]}),e.push(...l)})),e=n(e,s,o,y),w.data="path"===a?[r(e,c?1:0)]:e}return w}function c(e,{tolerance:t=.9,removeColinear:a=!0,useRDP:l=!0,radialDistance:n=!1,detectRegular:r=!1,decimals:i=-1,maxVertices:p=1/0,toMaxVertices:h=!1,outputFormat:c="points",scale:x=1,alignToZero:d=!1,translateX:v=0,translateY:w=0,scaleToWidth:M=0,scaleToHeight:b=0,meta:A=!1,toRelative:$=!1,toShorthands:k=!1,minifyString:L=!1}={}){try{e=s(e)}catch{return console.warn("invalid input"),e=[{x:0,y:0}]}let S=e[0].length>1,P=S?e:[e],j=[];for(let e=0,s=P.length;e<s;e++){let s=P[e],i=!1;if(!s.length)return[];let y=s;s.length<=2||1===t?j.push(y):h&&p<1/0?(y=u(s,p),j.push(y)):(y=a?f(y):y,y=n?g(y,t):y,r&&(i=o(y),i&&(l=!1)),l&&t<1&&(y=m(y,t)),j.push(y))}let O=y(P,j,c,A,i,$,k,L,x,v,w,d,M,b);return A?O:S?O.data:O.data[0]}function f(e){let t=e[0],a=[t];for(let l=2,n=e.length;l<n;l++){let r=e[l-1],s=e[l],o=0;if(t.x===r.x&&t.y!==r.y||t.x!==r.x&&t.y===r.y)s.x===r.x&&s.y!==r.y||s.x!==r.x&&s.y===r.y||a.push(r),t=r;else{if(!(t.x===r.x&&t.y===r.y||t.x===r.x&&t.y!==r.y||t.x!==r.x&&t.y===r.y)){o=i(r,s);let e=p([t,r,s],!0);!e||(!o||e<.01*o)||a.push(r)}t=r,l===n-1&&a.push(e[e.length-1])}}return a}function g(e,t=.9){let a,l=e[0],n=e[e.length-1],r=[l],s=u(e,12),{width:o,height:p}=h(s),y=1-t;y=(y*((o+p)/2/25))**2;for(let t=1,n=e.length-1;t<n;t++){a=e[t],i(l,a)>y&&(r.push(a),l=a)}return l.x!==n.x&&l.y!==n.y&&r.push(a),r}function m(e,t=.9){if(e.length<=2||t>=1)return e;let a=1-t,l=u(e,32),{width:n,height:r}=h(l);a=(a*((n+r)/2/100))**2;const s=(e,t,a)=>{let l=t.x,n=t.y,r=a.x-l,s=a.y-n;if(0!==r||0!==s){let t=((e.x-l)*r+(e.y-n)*s)/(r*r+s*s);t>1?(l=a.x,n=a.y):t>0&&(l+=r*t,n+=s*t)}return(e.x-l)**2+(e.y-n)**2};let i=[e[0]],o=[];for(o.push([0,e.length-1]);o.length>0;){let[t,l]=o.pop(),n=a,r=-1;for(let a=t+1;a<l;a++){let i=s(e[a],e[t],e[l]);i>n&&(r=a,n=i)}n>a?(o.push([r,l]),o.push([t,r])):i.push(e[l])}return i}"undefined"!=typeof window&&(window.polySimplify=c),e.minifyPathData=n,e.normalizePointInput=s,e.pathDataToD=r,e.polySimplify=c,e.simplifyPolyRDP=m,e.simplifyPolyRadialDistance=g,e.simplifyRemoveColinear=f}(this["poly-simplify"]=this["poly-simplify"]||{});
