!function(e){"use strict";function t(e){return function(e){let t=[{type:"M",values:e[0].values}],a=t[0];for(let l=1,r=e.length;l<r;l++){let r=e[l],{type:n,values:s}=r,i=s.length,o=a.values,u=o.length,[p,h]=[s[i-2],s[i-1]],[y,c]=[o[u-2],o[u-1]];switch(n){case"H":a={type:"L",values:[s[0],c]};break;case"V":a={type:"L",values:[y,s[0]]};break;case"z":case"Z":a={type:"Z",values:[]};break;case"M":a={type:"M",values:[s[0],s[1]]};break;default:a={type:"L",values:[p,h]}}t.push(a)}return t}(l(function(e,t=!0){const a={77:2,109:2,65:7,97:7,67:6,99:6,72:1,104:1,76:2,108:2,81:4,113:4,83:4,115:4,84:2,116:2,86:1,118:1,90:0,122:0};let l=new Set([...Object.keys(a).map(Number)]);const r=new Set([5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279]);function n(e){return 10===e||13===e||8232===e||8233===e||44===e||32===e||9===e||11===e||12===e||160===e||e>=5760&&r.has(e)>=0}function s(e){return l.has(e)}let i,o=0,u=e.length,p="",h=[],y=-1,c="",f=!1,g=!1,m=0,x=0,v=0,d=!1,M=[];const b=()=>{d&&("M"===p?p="L":"m"===p&&(p="l"),h.push({type:p,values:[]}),y++,x=0,d=!1)},w=(e=!1)=>{(e?m>0:""!==c)&&(t&&-1===y&&(i="Pathdata must start with M command",M.push(i),p="M",h.push({type:p,values:[]}),v=2,x=0,y++),"A"===p||"a"===p?(c=A(),h[y].values.push(...c)):(t&&c[1]&&"."!==c[1]&&"0"===c[0]&&(i="Leading zeros not valid: "+c,M.push(i)),h[y].values.push(+c)),x++,c="",m=0,d=x>=v)},A=()=>{let e=c.length,t=!1;return 3===x&&2===e||4===x&&e>1?(c=[+c[0],+c[1]],t=!0,x++):3===x&&e>=3&&(c=[+c[0],+c[1],+c.substring(2)],t=!0,x+=2),t?c:[+c]},$=()=>{if(t){let e=y>0?h[y]:0,t=e?e.values.length:0;(t&&t<v||t&&t>v||("z"===p||"Z"===p)&&t>0)&&(i=`Pathdata commands in "${p}" (segment index: ${y}) don't match allowed number of values: ${v-t}/${v}`,M.push(i))}};for(;o<u;){let t=e[o],l=e.charCodeAt(o);if(s(l)){""!==c&&(h[y].values.push(+c),x++,c=""),$(),p=t,v=a[l];let e="M"===p||"m"===p;y>0&&("z"===h[y].type||"Z"===h[y].type)&&!e&&(h.push({type:"m",values:[0,0]}),y++),h.push({type:p,values:[]}),y++,g=!1,m=0,x=0,d=!1,o++}else if(n(l))w(),g=!0,f=!1,o++;else{if(o===u-1){c+=t,w(),g=!1,f=!1,$();break}if(!f&&!g&&45===l||!f&&46===l){let e=46===l;w(e),b(),e&&m++}else b();c+=t,f=69===l||101===l,g=!1,o++}}if($(),h[0].type="M",t&&M.length){if(i="Invalid path data:\n"+M.join("\n"),"log"!==t)throw new Error(i);console.warn(i)}return h}(e),!1))}function a(e){let t=[{x:e[0].values[0],y:e[0].values[1]}];for(let a=1,l=e.length;a<l;a++){let{values:l}=e[a];if(l.length){let e=l.slice(-2);t.push({x:e[0],y:e[1]})}}return t}function l(e,t=!1){let a=e[0].values,l=a[0],r=a[1],n=l,s=r;for(let a=1,i=e.length;a<i;a++){let i=e[a],{type:o,values:u}=i,p=t?o.toLowerCase():o.toUpperCase();if(o!==p)switch(o=p,i.type=o,o){case"a":case"A":u[5]=t?u[5]-l:u[5]+l,u[6]=t?u[6]-r:u[6]+r;break;case"v":case"V":u[0]=t?u[0]-r:u[0]+r;break;case"h":case"H":u[0]=t?u[0]-l:u[0]+l;break;case"m":case"M":t?(u[0]-=l,u[1]-=r):(u[0]+=l,u[1]+=r),n=t?u[0]+l:u[0],s=t?u[1]+r:u[1];break;default:if(u.length)for(let e=0;e<u.length;e++)u[e]=t?u[e]-(e%2?r:l):u[e]+(e%2?r:l)}let h=u.length;switch(o){case"z":case"Z":l=n,r=s;break;case"h":case"H":l=t?l+u[0]:u[0];break;case"v":case"V":r=t?r+u[0]:u[0];break;case"m":case"M":n=u[h-2]+(t?l:0),s=u[h-1]+(t?r:0);default:l=u[h-2]+(t?l:0),r=u[h-1]+(t?r:0)}}return e[0].type="M",e}function r(e,t=-1,a=!1,r=!1){return r&&(e=function(e){let t,a=[{type:"M",values:e[0].values}],l=a[0],r={x:e[0].values[0],y:e[0].values[1]},n=.01;for(let s=1,i=e.length;s<i;s++){let i=e[s],{type:o,values:u}=i,p=u.length?u.slice(-2):[];t={x:p[0],y:p[1]};let h=Math.abs(t.x-r.x),y=Math.abs(t.y-r.y),c=(h+y)/2*n;switch(o){case"L":l=0===y||y<c&&h>c?{type:"H",values:[u[0]]}:0===h||y>c&&h<c?{type:"V",values:[u[1]]}:i;break;case"M":case"Z":case"z":l={type:o,values:p};break;default:l={type:"L",values:p}}r={x:p[0],y:p[1]},a.push(l)}return a}(e)),a&&(e=function(e){return l(e,!0)}(e)),t>-1&&(e=e.map((e=>({type:e.type,values:e.values.map((e=>+e.toFixed(t)))})))),e}function n(e,t=1){let a=t>1,l=!a;"l"===(e=JSON.parse(JSON.stringify(e)))[1].type&&l&&(e[0].type="m");let r="";r=a?`${e[0].type} ${e[0].values.join(" ")}\n`:`${e[0].type}${e[0].values.join(" ")}`;for(let t=1,n=e.length;t<n;t++){let n=e[t-1],s=e[t],{type:i,values:o}=s;if(!l||"A"!==i&&"a"!==i||(o=[o[0],o[1],o[2],`${o[3]}${o[4]}${o[5]}`,o[6]]),i=n.type===s.type&&"m"!==s.type.toLowerCase()&&l||("m"===n.type&&"l"===s.type||"M"===n.type&&"l"===s.type||"M"===n.type&&"L"===s.type)&&l?" ":s.type,l){let e="",t=!1;for(let a=0,l=o.length;a<l;a++){let l=o[a],r=l.toString(),n=r.includes(".")&&Math.abs(l)<1;n&&t&&(r=r.replace(/^0\./,".")),!(a>0)||t&&n||(e+=" "),e+=r,t=n}r+=`${i}${e}`}else r+=a?`${i} ${o.join(" ")}\n`:`${i}${o.join(" ")}`}return l&&(r=r.replace(/ 0\./g," .").replace(/ -/g,"-").replace(/-0\./g,"-.").replace(/Z/g,"z")),r}function s(e){if(!e||!e.length)return[];let l=e[0].x||!1;if(l&&e.length>0&&"object"==typeof e[0]&&e[0].constructor!==Object&&(e=>{let t=e.length,a=new Array(t);for(let l=0;l<t;l++)a[l]={x:e[l].x,y:e[l].y}})(e),l)return e;let r="string"==typeof e,n=!1;if(!!r&&(e.startsWith("M")||e.startsWith("m"))){0;let l=t(e),r=function(e){let t=[];try{e.map(((e,t)=>"m"===e.type.toLowerCase()?t:-1)).filter((e=>-1!==e))}catch{console.log("catch",e)}let a=e.map(((e,t)=>"m"===e.type.toLowerCase()?t:-1)).filter((e=>-1!==e));return 1===a.length?[e]:(a.forEach(((l,r)=>{t.push(e.slice(l,a[r+1]))})),t)}(l);n=r.length>1;let s=[];return n?r.forEach((e=>{let t=a(e);s.push(t)})):s=a(l),s}if(!!r&&(e.startsWith("{")||e.startsWith("["))&&(e=JSON.parse(e),r=!1),r){if((e=e.trim().split(/,| /).filter(Boolean).map(Number)).filter((e=>isNaN(e))).length)return console.warn("input doesn't contain point data â€“ please, check your input structure for syntax errors"),[]}return Array.isArray(e)&&2===e[0].length&&(e=e.map((e=>({x:e[0],y:e[1]})))),!Array.isArray(e[0])&&!e[0].hasOwnProperty("x")&&(e=(e=>{let t=[];for(let a=1,l=e.length;a<l;a+=2)t.push({x:e[a-1],y:e[a]});return t})(e)),e}function i(e,t){return(t.x-e.x)**2+(t.y-e.y)**2}function o(e){let t=i(e[0],e[1]);for(let a=3,l=e.length;a<l;a++){let l=i(e[a-1],e[a]);if(100/t*Math.abs(t-l)>.1)return!1;t=l}return!0}function u(e,t=48){if(!Array.isArray(e)||e.length<=t)return e;let a=e.length,l=a/t,r=[];for(let a=0;a<t;a++)r.push(e[Math.floor(a*l)]);let n=r.length;return r[n-1]!==e[a-1]&&(r[n-1]=e[a-1]),r}function p(e,t=!1){let a=0;for(let t=0,l=e.length;l&&t<l;t++){a+=e[t].x*e[t===e.length-1?0:t+1].y*.5-e[t===e.length-1?0:t+1].x*e[t].y*.5}return t?Math.abs(a):a}function h(e){let t=e.map((e=>e.x)),a=e.map((e=>e.y)),l=Math.min(...t),r=Math.max(...t),n=Math.min(...a),s=Math.max(...a);return{x:l,left:l,right:r,y:n,top:n,bottom:s,width:r-l,height:s-n}}function y(e,t,a="points",l=!1,s=-1,o=!1,y=!1,c=!1,f=1,g=0,m=0,x=!1,v=0,d=0){let M={data:[],ptsArr:[],countOriginal:0,count:0,areaOriginal:0,areaptsSmp:0,areaDiff:0,isPolygon:[]};t=function(e,t=1,a=0,l=0,r=!1,n=0,s=0){if(1===t&&0===n&&0===s&&0===a&&0===l&&!1===r)return e;let i,o,u,p,y=Array.isArray(e[0]),c=y?e:[e],f=y?e.flat():e;return({x:i,y:o,width:u,height:p}=h(f)),c.forEach(((e,h)=>{t=n?n/u:s?s/p:t,s&&p*t>s&&(t=s/p),r&&(a=-i,l=-o);for(let r=0,n=e.length;r<n;r++){let n=e[r];c[h][r]={x:(n.x+a)*t,y:(n.y+l)*t}}})),c}(t,f,g,m,x,v,d);for(let a=0,r=t.length;a<r;a++){let r=e[a],n=t[a],s=r.length;M.countOriginal+=s;let o=n.length;M.count+=o,M.ptsArr.push(n);let y=!1;if(l){let e=p(r,!0),t=p(n,!0);M.areaOriginal=e,M.areaptsSmp=t;let a=u(r,32),{width:s,height:o}=h(a),c=(Math.max(s,o)/r.length)**2;y=i(r[0],r[r.length-1])<c,M.isPolygon.push(y);let f=l?+(100/t*Math.abs(e-t)).toFixed(3):0;M.areaDiff+=f}}switch(a=a.toLowerCase()){case"points":case"pointstring":case"pointsnested":case"json":M.ptsArr=M.ptsArr.map((e=>e.map((e=>({x:+e.x.toFixed(s),y:+e.y.toFixed(s)}))))),"pointstring"===a?M.data=M.ptsArr.map((e=>e.map((e=>`${e.x} ${e.y}`)).join(" "))):"points"===a?M.data=M.ptsArr:"pointsnested"===a?M.data=M.ptsArr.map((e=>e.map((e=>[e.x,e.y])))):"json"===a&&(M.data=JSON.stringify(M.ptsArr));break;case"pathdata":case"path":let e=[];M.ptsArr.forEach(((t,a)=>{let l=[{type:"M",values:[t[0].x,t[0].y]},...t.slice(1).map((e=>({type:"L",values:[e.x,e.y]})))];M.isPolygon[a]&&l.push({type:"Z",values:[]}),e.push(...l)})),e=r(e,s,o,y),M.data="path"===a?[n(e,c?1:0)]:e}return M}function c(e,{tolerance:t=.1,removeColinear:a=!0,useRDP:l=!0,detectRegular:r=!1,decimals:n=-1,maxVertices:i=1/0,toMaxVertices:p=!1,outputFormat:h="points",scale:c=1,alignToZero:m=!1,translateX:x=0,translateY:v=0,scaleToWidth:d=0,scaleToHeight:M=0,meta:b=!1,toRelative:w=!1,toShorthands:A=!1,minifyString:$=!1}={}){let k=(e=s(e))[0].length>1,L=k?e:[e],S=[];for(let e=0,n=L.length;e<n;e++){let n=L[e],s=!1;if(!n.length)return[];let h=n;n.length<=2||0===t?S.push(h):p&&i<1/0?(h=u(n,i),S.push(h)):(h=a?f(h,k):h,r&&(s=o(h),s&&(l=!1)),l&&(h=g(h,t,k)),S.push(h))}let j=y(L,S,h,b,n,w,A,$,c,x,v,m,d,M);return b?j:j.data}function f(e,t=!1){let a=e[0],l=[a];for(let t=2,r=e.length;t<r;t++){let n=e[t-1],s=e[t],o=0;if(a.x===n.x&&a.y!==n.y||a.x!==n.x&&a.y===n.y)s.x===n.x&&s.y!==n.y||s.x!==n.x&&s.y===n.y||l.push(n),a=n;else{if(!(a.x===n.x&&a.y===n.y||a.x===n.x&&a.y!==n.y||a.x!==n.x&&a.y===n.y)){o=i(n,s);let e=p([a,n,s],!0);!e||(!o||e<.01*o)||l.push(n)}a=n,t===r-1&&l.push(e[e.length-1])}}return l}function g(e,t=.1,a=!1){if(e.length<=2)return e;let l=u(e,32),{width:r,height:n}=h(l),s=Math.max(r,n);t/=s<=10?1e5/s:1;const i=(e,t,a)=>{let l=t.x,r=t.y,n=a.x-l,s=a.y-r;if(0!==n||0!==s){let t=((e.x-l)*n+(e.y-r)*s)/(n*n+s*s);t>1?(l=a.x,r=a.y):t>0&&(l+=n*t,r+=s*t)}return(e.x-l)**2+(e.y-r)**2};let o=[e[0]],p=[];for(p.push([0,e.length-1]);p.length>0;){let[a,l]=p.pop(),r=t,n=-1;for(let t=a+1;t<l;t++){let s=i(e[t],e[a],e[l]);s>r&&(n=t,r=s)}r>t?(p.push([n,l]),p.push([a,n])):o.push(e[l])}return o}"undefined"!=typeof window&&(window.polySimplify=c),e.minifyPathData=r,e.normalizePointInput=s,e.pathDataToD=n,e.polySimplify=c,e.simplifyPolyRDP=g,e.simplifyRemoveColinear=f}(this["poly-simplify"]=this["poly-simplify"]||{});
